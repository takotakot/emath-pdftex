\documentclass[a4j,fleqn]{jarticle}
\usepackage{color}
\usepackage{emathMw}
\usepackage{emathPh}
\usepackage{emathPb}
\usepackage{emathEy}
\usepackage{emathAt}
\usepackage{emathR}
\usepackage{showexample}
%\usepackage{type1cm}% ps, pdf を作るときには必要


\begin{document}

\title{左右に注釈\\
emathAt.sty {\normalsize ver.0.02α}}
\author{tDB}
\date{2002/03/05}

\maketitle\thispagestyle{empty}
\begin{abstract}%
\centerline{左右に注釈をつける}
\end{abstract}

\tableofcontents

\pagebreak
\pagenumbering{arabic}

\section{\texttt{tyuukai}環境と\cmd{tyuu}コマンド}
\verb+emathAt.sty+ は，問題の解答部分を2段組にして，左側に解答を，
右側に注釈を付けることを目的としたスタイルファイルです。

この2段組を実現する \verb+tyuukai+環境と，注釈を付ける\verb+\tyuu+
コマンドが主たるものです。

まず実例をご覧いただきましょう。

\begin{itembox}{問題}
問題部分および地の文は，通常の\verb+\textwidth+で組まれます。
問題問題問題問題問題問題問題問題問題問題問題問題問題問題問題
問題問題問題問題問題問題問題問題問題問題問題問題問題問題問題
\end{itembox}
\begin{tyuukai}
【解答】解答部分は\verb+tyuukai+環境内に記述します。
そこでは，右側一部が注釈のための領域となります。
これは，\verb+jquotation+環境によって実現されています。

\tyuu{注釈領域です。
注釈を付けるには，\cmd{tyuu}コマンドを用います。}
ここで注釈をつけてみます。
解答解答解答解答解答解答解答解答解答解答解答解答解答
解答解答解答解答解答解答解答解答解答解答解答解答解答
\end{tyuukai}

\verb+tyuukai+環境が終ったあとは，通常の\verb+\textwidth+幅にもどります。
地の文地の文地の文地の文地の文地の文地の文地の文地の文地の文地の文地の文
地の文地の文地の文地の文地の文地の文地の文地の文地の文地の文地の文地の文
\clearpage

\section{注釈領域の横幅指定}
注釈領域の横幅はデフォルトでは \verb+\textwidth+の3/10となっています。
これを変更するには，\verb+emathAt.sty+の内部変数\cmd{tyuuhaba}に
単位付きの長さを指定します。
\begin{jquote}
 例：\verb+\tyuuhaba=8zw+
\end{jquote}

{\tyuuhaba=8zw\relax
\begin{itembox}{問題}
問題部分および地の文は，通常の\verb+\textwidth+で組まれます。
問題問題問題問題問題問題問題問題問題問題問題問題問題問題問題
問題問題問題問題問題問題問題問題問題問題問題問題問題問題問題
\end{itembox}
\begin{tyuukai}
%【解答】解答部分は\verb+tyuukai+環境内に記述します。
そこでは，右側一部が注釈のための領域となります。
ここでは，\verb+\tyuuhaba=8zw+として注釈領域の
横幅を制限しています。

\tyuu{注釈領域です。
注釈を付けるには，\cmd{tyuu}コマンドを用います。}
ここで注釈をつけてみます。
解答解答解答解答解答解答解答解答解答解答解答解答解答
解答解答解答解答解答解答解答解答解答解答解答解答解答
解答解答解答解答解答解答解答解答解答解答解答解答解答
解答解答解答解答解答解答解答解答解答解答解答解答解答
\end{tyuukai}
}
\clearpage
\section{注釈文，表示位置の微調整}
数式行は改行ピッチなどが通常の文と異なるため，
注釈文の位置に不満が出ることがあります。
\begin{itembox}{問題}
問題問題問題問題問題問題問題問題問題問題問題問題問題問題問題
問題問題問題問題問題問題問題問題問題問題問題問題問題問題問題
\end{itembox}
\begin{tyuukai}
与えられた式の両辺に
\tyuu{$a$を加えて}%
\[ x+a=y+a \]
さらに
\end{tyuukai}
\bigskip

\noindent
という例では，注釈文の位置を下にずらしたくなります。
これを実現するのが\cmd{tyuu}の\verb+<...>+オプションです。
下の例では\verb+\tyuu<12pt>{...}+として，注釈文を下方に\texttt{12pt}
下げています。

\begin{itembox}{問題}
問題問題問題問題問題問題問題問題問題問題問題問題問題問題問題
問題問題問題問題問題問題問題問題問題問題問題問題問題問題問題
\end{itembox}
\begin{tyuukai}
与えられた式の両辺に
\tyuu<12pt>{$a$を加えて}%
\[ x+a=y+a \]
さらに
\end{tyuukai}
\clearpage

\section{\textsf{mawarikomi}環境との併用}
解答の中で\textsf{mawarikomi}環境を使用し，その中で注釈をつけるのは
ちと面倒です。まず，普通の使い方をした場合を見ましょう。

\begin{itembox}{問題}
問題問題問題問題問題問題問題問題問題問題問題問題問題問題問題
問題問題問題問題問題問題問題問題問題問題問題問題問題問題問題
\end{itembox}
\begin{tyuukai}
解答文，解答文，解答文，解答文，解答文，解答文，解答文，解答文

\tyuu{注釈1注釈1注釈1注釈1注釈1注釈1注釈1注釈1注釈1注釈1注釈1}
ここで注釈をつけます。
解答文，解答文，解答文，解答文，解答文，解答文，解答文，解答文，
解答文，解答文，解答文，解答文

\begin{mawarikomi}{}{%
  \begin{zahyou*}[ul=1cm](-1,1)(-1,1)
    \Drawline{\LT\LB\RB\RT\LT}
    \En\O1
  \end{zahyou*}}
ここから\textsf{mawarikomi}環境です。
まわりこみまわりこみまわりこみまわりこみまわりこみ

\tyuu{\textsf{mawarikomi}環境内の注釈です}
ここで注釈をつけます。
まわりこみまわりこみまわりこみまわりこみまわりこみまわりこみ
まわりこみまわりこみまわりこみまわりこみまわりこみまわりこみ
まわりこみまわりこみまわりこみまわりこみまわりこみまわりこみ
まわりこみまわりこみまわりこみまわりこみまわりこみまわりこみ
\end{mawarikomi}
\end{tyuukai}

注釈の横幅が狭くなるなどの不具合がみられます。
これを修正してみましょう。

\begin{itembox}{問題}
問題問題問題問題問題問題問題問題問題問題問題問題問題問題問題
問題問題問題問題問題問題問題問題問題問題問題問題問題問題問題
\end{itembox}
\begin{tyuukai}
解答文，解答文，解答文，解答文，解答文，解答文，解答文，解答文

\tyuu{注釈1注釈1注釈1注釈1注釈1注釈1注釈1注釈1注釈1注釈1注釈1}
ここで注釈をつけます。
解答文，解答文，解答文，解答文，解答文，解答文，解答文，解答文，
解答文，解答文，解答文，解答文

\begin{mawarikomi}{}{%
  \begin{zahyou*}[ul=1cm](-1,1)(-1,1)
    \Drawline{\LT\LB\RB\RT\LT}
    \En\O1
  \end{zahyou*}}
ここから\textsf{mawarikomi}環境です。
まわりこみまわりこみまわりこみまわりこみまわりこみ

\tyuu{\makebox[0pt][l]{\parbox[t]{\tyuuhaba-\leftmargin}{%
  \textsf{mawarikomi}環境内の注釈注釈注釈注釈
  \textsf{mawarikomi}環境内の注釈}}}
ここで注釈をつけます。
まわりこみまわりこみまわりこみまわりこみまわりこみまわりこみ
まわりこみまわりこみまわりこみまわりこみまわりこみまわりこみ
まわりこみまわりこみまわりこみまわりこみまわりこみまわりこみ
まわりこみまわりこみまわりこみまわりこみまわりこみまわりこみ
\end{mawarikomi}
\end{tyuukai}
修正部分は
\begin{jquote}
\begin{verbatim}
\tyuu{\makebox[0pt][l]{\parbox[t]{\tyuuhaba-\leftmargin}{注釈文}}}
\end{verbatim}
\end{jquote}
と，\cmd{parbox}で横幅を指定し，\cmd{makebox[0pt]}で横幅を0と偽るとは，
面倒なことですが，現時点ではほかにうまい方法がみつかりません。

\section{注釈記号の変更}
デフォルトでは，注釈の冒頭に`$\longleftarrow$'がつきます。
この記号を変更するには
\begin{jquote}
\begin{verbatim}
\renewcommand{tyuumark}{$\blacktriangleleft$}
\end{verbatim}
\end{jquote}
などとします。


{\renewcommand{\tyuumark}{$\blacktriangleleft$}
\begin{itembox}{問題}
問題部分および地の文は，通常の\verb+\textwidth+で組まれます。
問題問題問題問題問題問題問題問題問題問題問題問題問題問題問題
問題問題問題問題問題問題問題問題問題問題問題問題問題問題問題
\end{itembox}
\begin{tyuukai}
【解答】解答部分は\verb+tyuukai+環境内に記述します。
そこでは，右側一部が注釈のための領域となります。
これは，\verb+jquotation+環境によって実現されています。

\tyuu{注釈領域です。
注釈を付けるには，\cmd{tyuu}コマンドを用います。}
ここで注釈をつけてみます。
解答解答解答解答解答解答解答解答解答解答解答解答解答
解答解答解答解答解答解答解答解答解答解答解答解答解答
\end{tyuukai}

更にこの場合は，注釈部分の左インデントが大きすぎるようですから，
それを修正するためのコマンド
\begin{jquote}
\begin{verbatim}
\tyuuitemizeoption
\end{verbatim}
\end{jquote}
を設けました。下の例では
\begin{jquote}
\begin{verbatim}
\def\tyuuitemizeoption{%
  \labelwidth=6pt\labelsep=3pt\leftmargin9pt\footnotesize}
\end{verbatim}
\end{jquote}
としています。

\def\tyuuitemizeoption{%
  \labelwidth=6pt\labelsep=3pt\leftmargin9pt\footnotesize}
\begin{itembox}{問題}
問題部分および地の文は，通常の\verb+\textwidth+で組まれます。
問題問題問題問題問題問題問題問題問題問題問題問題問題問題問題
問題問題問題問題問題問題問題問題問題問題問題問題問題問題問題
\end{itembox}
\begin{tyuukai}
【解答】解答部分は\verb+tyuukai+環境内に記述します。
そこでは，右側一部が注釈のための領域となります。
これは，\verb+jquotation+環境によって実現されています。

\tyuu{注釈領域です。
注釈を付けるには，\cmd{tyuu}コマンドを用います。}
ここで注釈をつけてみます。
解答解答解答解答解答解答解答解答解答解答解答解答解答
解答解答解答解答解答解答解答解答解答解答解答解答解答
\end{tyuukai}
}
\clearpage

\section{制約}
現時点では，ページをまたがる場合には2つの領域間の罫線をひくことが
できません。ページをまたがる場合は
\begin{jquote}
\begin{verbatim}
\tyuukeisenfalse
\end{verbatim}
\end{jquote}
として，罫線をひかない設定にしてください。

\begin{itembox}{問題}
問題問題問題問題問題問題問題問題問題問題問題問題問題問題問題
問題問題問題問題問題問題問題問題問題問題問題問題問題問題問題
\end{itembox}
\tyuukeisenfalse
\begin{tyuukai}
【解答】長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答

\tyuu{注釈1}ここで注釈を付けます。
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答

\tyuu{注釈2}ここで注釈その２を付けます。
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
長い解答長い解答長い解答長い解答長い解答長い解答長い解答
\end{tyuukai}

\section{左注}
\cmd{tyuu}は右欄外に注釈をおきますが，左欄外に注釈を置くには
\cmd{hidarityuu}を用います。

\tyuukeisentrue
\hidarityuukeisentrue
\begin{itembox}{問題}
問題部分および地の文は，通常の\verb+\textwidth+で組まれます。
問題問題問題問題問題問題問題問題問題問題問題問題問題問題問題
問題問題問題問題問題問題問題問題問題問題問題問題問題問題問題
\end{itembox}
\begin{tyuukai}
【解答】解答部分は\verb+tyuukai+環境内に記述します。
そこでは，右側一部が注釈のための領域となります。
これは，\verb+jquotation+環境によって実現されています。

\tyuu{注釈領域です。
注釈を付けるには，\cmd{tyuu}コマンドを用います。}
ここで注釈をつけてみます。
解答解答解答解答解答解答解答解答解答解答解答解答解答
解答解答解答解答解答解答解答解答解答解答解答解答解答

次に左欄外に注をつけてみましょう。
\hidarityuu{左欄外に注釈をつけるコマンドが \cmd{hidarityuu}です。}

ただし，右欄外の注が本文幅の中に入るのに対して，
左欄外の注は本文外に入る仕様としてあります。
これは，左欄外の注は簡単なマーク程度を想定しているからです。

例えば，\hidarityuu{\hfill ☆}このような使い方です。
とすれば，左欄外注と本文の間の罫線を引くべきかどうか問題でしょう。
デフォルトは罫線なしです。罫線を引きたければ，
\begin{jquote}
\begin{verbatim}
\hidarityuukeisentrue
\end{verbatim}
\end{jquote}
を宣言します。

\cmd{hidarityuu}は\cmd{marginpar}を使用していますから，
一つの段落には左右どちらか一方にしか注をつけることが
できません。
\end{tyuukai}
\clearpage

\section{行頭，左欄外にマーク}
左欄外にマークだけをつけたいときもあります。そのためのコマンドが
\begin{jquote}
\begin{verbatim}
\gyoutou
\end{verbatim}
\end{jquote}
です。このコマンドは\cmd{marginpar}を使用していませんから，
当該段落に\cmd{tyuu}を使用して，注釈をつけることができます。

\hidarityuukeisenfalse
\begin{itembox}{問題}
問題部分および地の文は，通常の\verb+\textwidth+で組まれます。
問題問題問題問題問題問題問題問題問題問題問題問題問題問題問題
問題問題問題問題問題問題問題問題問題問題問題問題問題問題問題
\end{itembox}
\begin{tyuukai}
【解答】\tyuu{注釈領域です。
注釈を付けるには，\cmd{tyuu}コマンドを用います。}
ここで注釈をつけてみます。
解答解答解答解答解答解答解答解答解答解答解答解答解答
解答解答解答解答解答解答解答解答解答解答解答解答解答

\indent
\gyoutou{\P}
段落の先頭で，行頭にマークをつけてみます。この行の冒頭には
\begin{jquote}
\begin{verbatim}
\indent\gyoutou{\P}
\end{verbatim}
\end{jquote}
と記述してあります。

\noindent\gyoutou{\fbox{1}}この行はインデントをつけずに，\fbox1を
欄外につけています。この場合は
\begin{jquote}
\begin{verbatim}
\noindent\gyoutou{\fbox{1}}
\end{verbatim}
\end{jquote}
\cmd{gyoutou}の前に\cmd{noindent}をつけます。

\gyoutou{☆}
\tyuu<-13pt>{右注釈}
この機能は，\cmd{marginpar} を使用していませんので，
右欄外の注釈をつけるコマンド \cmd{tyuu} と \cmd{gyoutou} を
併用することも可能です。　　　　
\end{tyuukai}
\clearpage

\section{具体例}
\ReadTeXFile{ex6}
\end{document}
